import{t as Q,G as oe,al as te,ak as de,an as le,h as G,U as F,p as T,J as ie,ch as ce,ao as ue,j as e,a2 as me,aq as xe,S as y,D as he,T as Z,ar as t,as as l,at as i,au as m,av as x,I as pe,aw as Ce,a as je,R as X,r as fe,H as ge,B as _e,ax as ve,c as Ee}from"./index-BmfGJE-Y.js";import{A as Fe}from"./ArrowLeft-uFTLAPnv.js";import{s as h,Z as _,o as Ie,c as f,u as Pe,t as ye}from"./index-jjTw8nlg.js";import{V as O}from"./validateCPFCNPJ-DPNkBWup.js";import{M as I}from"./reactTextMask-PSz5W310.js";import{w as Be,A as Se}from"./autocompletecidades-Ccxhvhck.js";import{L as ke}from"./LoadingButton-gJW1zksJ.js";import"./Select-CJvL_hJA.js";const Ue=async r=>{try{return r=r.replace(/[\D]/g,""),r==="00000000000"||r==="00000000000000"?!0:(await Q.get(`/Clientes/v1/VerificarCpfCnpj?cd_CpfCnpj=${r}`)).data}catch(d){return console.log("Valida CPF/CNPJ Erro",d),!1}},U=r=>{if(r==null)return!0;var d=r.replace(/[\D]/g,"");return d===""?!0:!(d.length<10||d.length>11)},K=h().min(11,"CPF Inválido").superRefine((r,d)=>{if(r=r.replace(/[\D]/g,""),r==="00000000000"||r==="00000000000000")return!0;r.length<11?d.addIssue({code:_.custom,message:"CPF Inválido"}):r.length==11?O.isCPF(r)||d.addIssue({code:_.custom,message:"CPF Incorreto"}):r.length>11&&r.length<14?d.addIssue({code:_.custom,message:"CNPJ Inválido"}):r.length==14?O.isCNPJ(r)||d.addIssue({code:_.custom,message:"CNPJ Incorreto"}):d.addIssue({code:_.custom,message:"CPF/CNPJ Inválido"})}),Te=h().superRefine((r,d)=>{if(r=r.replace(/[\D]/g,""),r===""||r==="0".repeat(r.length))return!0}).optional(),Re=h({required_error:"Informe o E-mail"}).min(1,"Informe o E-mail").max(255,"Máximo de 255 Caracteres").email("E-mail Inválido").toLowerCase().optional(),be=Ie({cd_CpfCnpj:K,cd_IE:Te,ds_RazaoSocial:h({required_error:"Informe a Razão Social"}).min(1,"Informe a Razão Social").max(255,"Máximo de 255 Caracteres").toUpperCase(),ds_NomeFantasia:h({required_error:"Informe o Nome Fantasia"}).min(1,"Informe o Nome Fantasia").max(255,"Máximo de 255 Caracteres").toUpperCase(),ds_Email:Re,cd_CEP:f(h().min(8,"Cep Inválido").toUpperCase()),ds_Endereco:f(h().max(255,"Máximo de 255 Caracteres").toUpperCase()),nr_Endereco:f(h().max(255,"Máximo de 255 Caracteres").toUpperCase()),ds_Bairro:f(h().max(255,"Máximo de 255 Caracteres").toUpperCase()),ds_Complemento:f(h().max(255,"Máximo de 255 Caracteres").toUpperCase()),ds_Cidade:f(Pe().transform(r=>r.cidade.toUpperCase())),cd_UF:f(h().max(255,"Máximo de 255 Caracteres").toUpperCase()),nr_Telefone:h().refine(r=>U(r),"Telefone Inválido").optional(),nr_Celular:h().refine(r=>U(r),"Celular Inválido").optional(),nr_Contato:h().refine(r=>U(r),"Contato Inválido").optional()}).superRefine(async(r,d)=>{if((await K.safeParseAsync(r.cd_CpfCnpj)).success&&!await Ue(r.cd_CpfCnpj)){let j=r.cd_CpfCnpj.replace(/[\D]/g,"").length<=11?"CPF":"CNPJ";d.addIssue({code:_.custom,message:`${j} já cadastrado!`,path:["cd_CpfCnpj"]})}}),we=()=>{oe();const[r,d]=te(),C=de(),j={cd_CpfCnpj:"000.000.000-00",cd_IE:"",ds_RazaoSocial:"",ds_NomeFantasia:"",ds_Email:"",ds_Endereco:"",nr_Endereco:"",ds_Bairro:"",ds_Complemento:"",ds_Cidade:{cidade:"",uf:""},cd_UF:"",nr_Telefone:"",nr_Celular:"",nr_Contato:""},{control:R,handleSubmit:B,watch:b,setError:s,setValue:o,setFocus:v,getValues:P,clearErrors:E,formState:{errors:S,isLoading:k,isValidating:n,isSubmitting:a}}=le({mode:"onSubmit",reValidateMode:"onBlur",defaultValues:j,resolver:ye(be)}),c=G.useCallback(async p=>{try{(await Q.post("/Fornecedores/v1/Criar",p)).status===200?(F.success("Fornecedores Cadastrado Com Sucesso!"),C(T.dashboard.cadastros.fornecedores.listar)):F.error("Falha ao Criar Fornecedor")}catch{F.error("Something went wrong!")}},[C]),{refetch:Y,isLoading:w}=ie({queryKey:["buscaCEP"],queryFn:async()=>{var u;let p=await ce.get(`https://viacep.com.br/ws/${(u=P("cd_CEP"))==null?void 0:u.replace(/\D/g,"")}/json/`);if(p.status===200)return p.data;throw new Error("Cep Inválido")},enabled:!1}),ee=async p=>{var N,W,D,L,z,M,V,q,J,A,H,$;d(!0);try{var u=P("cd_CEP");if(u=u==null?void 0:u.replace(/\D/g,""),(u==null?void 0:u.length)==8){var g=await Y();const ae={cidade:(W=(N=g.data.localidade)==null?void 0:N.toString())==null?void 0:W.toUpperCase(),uf:(L=(D=g.data.uf)==null?void 0:D.toString())==null?void 0:L.toUpperCase()};o("ds_Endereco",(M=(z=g.data.logradouro)==null?void 0:z.toString())==null?void 0:M.toUpperCase()),o("nr_Endereco",""),o("ds_Bairro",(q=(V=g.data.bairro)==null?void 0:V.toString())==null?void 0:q.toUpperCase()),o("ds_Complemento",(A=(J=g.data.complemento)==null?void 0:J.toString())==null?void 0:A.toUpperCase()),o("ds_Cidade",ae),o("cd_UF",($=(H=g.data.uf)==null?void 0:H.toString())==null?void 0:$.toUpperCase()),F.success("Endereço capturado com sucesso"),setTimeout(()=>{v("nr_Endereco")},500)}else o("cd_CEP",""),v("cd_CEP"),F.error("CEP Inválido")}finally{d(!1)}},re=p=>p.replace(/\D/g,"").length>10?["(",/\d/,/\d/,")"," ",/\d/,".",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]:["(",/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/],se=p=>p.replace(/\D/g,"").length<=11?[/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"-",/\d/,/\d/]:[/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/],ne=p=>[/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/];return G.useEffect(()=>{d(w)},[w]),{Controller:ue,handleSubmit:B,handleCep:ee,onSubmit:c,setError:s,setFocus:v,setValue:o,clearErrors:E,watch:b,control:R,errors:S,defaultValues:j,isLoading:k,isValidating:n,isSubmitting:a,navigate:C,maskTelefone:re,maskCpfCnpj:se,maskCep:ne}};function Ne(){var{Controller:r,handleSubmit:d,handleCep:C,setValue:j,setFocus:R,onSubmit:B,watch:b,errors:s,control:o,isSubmitting:v,navigate:P,maskTelefone:E,maskCpfCnpj:S,maskCep:k}=we();return e.jsx("form",{onSubmit:d(B),children:e.jsxs(me,{children:[e.jsx(xe,{children:e.jsx(y,{divider:e.jsx(he,{}),spacing:4,children:e.jsxs(y,{spacing:3,children:[e.jsx(Z,{variant:"h6",children:"Informações Basicas"}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{md:4,xsOffset:0,xs:12,children:e.jsx(r,{control:o,name:"cd_CpfCnpj",rules:{maxLength:14},render:({field:n})=>e.jsxs(l,{error:!!s.cd_CpfCnpj,fullWidth:!0,children:[e.jsx(i,{required:!0,children:"CPF/CNPJ"}),e.jsx(I,{value:n.value,mask:S,keepCharPositions:!0,guide:!1,render:(a,c)=>e.jsx(m,{inputRef:a,ref:n.ref,...c}),onChange:a=>{n.onChange(a)},onBlur:a=>{n.onBlur()}}),s.cd_CpfCnpj?e.jsx(x,{children:s.cd_CpfCnpj.message}):null]})})}),e.jsx(t,{md:4,xsOffset:0,xs:12,children:e.jsx(r,{control:o,name:"cd_IE",rules:{maxLength:14},render:({field:n})=>e.jsxs(l,{error:!!s.cd_IE,fullWidth:!0,children:[e.jsx(i,{children:"RG/IE"}),e.jsx(m,{...n}),s.cd_IE?e.jsx(x,{children:s.cd_IE.message}):null]})})})]}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{md:6,xs:12,children:e.jsx(r,{control:o,name:"ds_RazaoSocial",render:({field:n})=>e.jsxs(l,{error:!!s.ds_RazaoSocial,fullWidth:!0,children:[e.jsx(i,{required:!0,children:"Razão Social"}),e.jsx(m,{inputProps:{style:{textTransform:"uppercase"}},...n}),s.ds_RazaoSocial?e.jsx(x,{children:s.ds_RazaoSocial.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(r,{control:o,name:"ds_NomeFantasia",render:({field:n})=>e.jsxs(l,{error:!!s.ds_NomeFantasia,fullWidth:!0,children:[e.jsx(i,{children:"Nome Fantasia"}),e.jsx(m,{inputProps:{style:{textTransform:"uppercase"}},...n}),s.ds_NomeFantasia?e.jsx(x,{children:s.ds_NomeFantasia.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(r,{control:o,name:"ds_Email",render:({field:n})=>e.jsxs(l,{error:!!s.ds_Email,fullWidth:!0,children:[e.jsx(i,{children:"E-mail"}),e.jsx(m,{inputProps:{style:{textTransform:"uppercase"}},...n}),s.ds_NomeFantasia?e.jsx(x,{children:s.ds_Email.message}):null]})})}),e.jsx(t,{md:6}),e.jsx(t,{md:3,xs:12,children:e.jsx(r,{control:o,name:"cd_CEP",render:({field:n})=>e.jsxs(l,{error:!!s.cd_CEP,fullWidth:!0,children:[e.jsx(i,{children:"CEP"}),e.jsx(I,{value:n.value,mask:k,keepCharPositions:!0,guide:!1,render:(a,c)=>e.jsx(m,{inputRef:a,ref:n.ref,sx:{paddingRight:0},endAdornment:e.jsx(pe,{tabIndex:-1,onClick:C,children:e.jsx(Be,{})}),...c}),onChange:a=>{n.onChange(a)},onBlur:a=>{n.onBlur()},onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),C(a))}}),s.cd_CEP?e.jsx(x,{children:s.cd_CEP.message}):null]})})}),e.jsx(t,{md:7,xs:12,children:e.jsx(r,{control:o,name:"ds_Endereco",render:({field:n})=>e.jsxs(l,{error:!!s.ds_Endereco,fullWidth:!0,children:[e.jsx(i,{children:"Endereço"}),e.jsx(m,{inputProps:{style:{textTransform:"uppercase"}},...n}),s.ds_Endereco?e.jsx(x,{children:s.ds_Endereco.message}):null]})})}),e.jsx(t,{md:2,xs:12,children:e.jsx(r,{control:o,name:"nr_Endereco",render:({field:n})=>e.jsxs(l,{error:!!s.nr_Endereco,fullWidth:!0,children:[e.jsx(i,{children:"N°"}),e.jsx(m,{inputProps:{style:{textTransform:"uppercase"}},...n}),s.nr_Endereco?e.jsx(x,{children:s.nr_Endereco.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(r,{control:o,name:"ds_Bairro",render:({field:n})=>e.jsxs(l,{error:!!s.ds_Bairro,fullWidth:!0,children:[e.jsx(i,{children:"Bairro"}),e.jsx(m,{inputProps:{style:{textTransform:"uppercase"}},...n}),s.ds_Bairro?e.jsx(x,{children:s.ds_Bairro.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(r,{control:o,name:"ds_Complemento",render:({field:n})=>e.jsxs(l,{error:!!s.ds_Complemento,fullWidth:!0,children:[e.jsx(i,{children:"Complemento"}),e.jsx(m,{inputProps:{style:{textTransform:"uppercase"}},...n}),s.ds_Complemento?e.jsx(x,{children:s.ds_Complemento.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(r,{control:o,name:"ds_Cidade",render:({field:n})=>e.jsxs(l,{error:!!s.ds_Cidade,fullWidth:!0,children:[e.jsx(i,{children:"Cidade"}),e.jsx(Se,{options:[],value:n.value,onChange:(a,c)=>{j("ds_Cidade",c),j("cd_UF",c.uf)}})]})})}),e.jsx(t,{md:2,xs:12,children:e.jsx(r,{control:o,name:"cd_UF",rules:{maxLength:2},render:({field:n})=>e.jsxs(l,{error:!!s.cd_UF,fullWidth:!0,children:[e.jsx(i,{children:"UF"}),e.jsx(m,{inputProps:{maxLength:2,style:{textTransform:"uppercase"}},...n}),s.cd_UF?e.jsx(x,{children:s.cd_UF.message}):null]})})}),e.jsx(t,{md:4,xs:12,children:e.jsx(t,{container:!0,spacing:1,children:e.jsx(t,{xs:!0,children:e.jsx(r,{control:o,name:"nr_Celular",render:({field:n})=>e.jsxs(l,{error:!!s.nr_Celular,fullWidth:!0,children:[e.jsx(i,{children:"Celular"}),e.jsx(I,{value:n.value,mask:E,keepCharPositions:!0,guide:!1,render:(a,c)=>e.jsx(m,{inputRef:a,ref:n.ref,...c}),onChange:a=>{n.onChange(a.target.value)}}),s.nr_Celular?e.jsx(x,{children:s.nr_Celular.message}):null]})})})})}),e.jsx(t,{md:4,xs:12,children:e.jsx(t,{container:!0,spacing:1,children:e.jsx(t,{xs:!0,children:e.jsx(r,{control:o,name:"nr_Telefone",render:({field:n})=>e.jsxs(l,{error:!!s.nr_Telefone,fullWidth:!0,children:[e.jsx(i,{children:"Telefone"}),e.jsx(I,{value:n.value,mask:E,keepCharPositions:!0,guide:!1,render:(a,c)=>e.jsx(m,{inputRef:a,ref:n.ref,...c}),onChange:a=>{n.onChange(a.target.value)}}),s.nr_Telefone?e.jsx(x,{children:s.nr_Telefone.message}):null]})})})})}),e.jsx(t,{md:4,xs:12,children:e.jsx(t,{container:!0,spacing:1,children:e.jsx(t,{xs:!0,children:e.jsx(r,{control:o,name:"nr_Contato",render:({field:n})=>e.jsxs(l,{error:!!s.nr_Contato,fullWidth:!0,children:[e.jsx(i,{children:"Contato"}),e.jsx(I,{value:n.value,mask:E,keepCharPositions:!0,guide:!1,render:(a,c)=>e.jsx(m,{inputRef:a,ref:n.ref,...c}),onChange:a=>{n.onChange(a.target.value)}}),s.nr_Contato?e.jsx(x,{children:s.nr_Contato.message}):null]})})})})})]})]})})}),e.jsxs(Ce,{sx:{justifyContent:"flex-end"},children:[e.jsx(je,{color:"secondary",component:X,onClick:()=>{P(T.dashboard.cadastros.clientes.listar)},children:"Cancelar"}),e.jsx(ke,{type:"submit",loadingIndicator:"Salvando...",loading:v,variant:"outlined",children:"Cadastrar Cliente"})]})]})})}const We={title:`Create |  | Dashboard | ${Ee.site.name}`};function He(){return e.jsxs(fe.Fragment,{children:[e.jsx(ge,{children:e.jsx("title",{children:We.title})}),e.jsx(_e,{sx:{maxWidth:"var(--Content-maxWidth)",m:"var(--Content-margin)",p:"var(--Content-padding)",width:"var(--Content-width)"},children:e.jsxs(y,{spacing:4,children:[e.jsxs(y,{spacing:3,children:[e.jsx("div",{children:e.jsxs(ve,{color:"text.primary",component:X,href:T.dashboard.cadastros.fornecedores.listar,sx:{alignItems:"center",display:"inline-flex",gap:1},variant:"subtitle2",children:[e.jsx(Fe,{fontSize:"var(--icon-fontSize-md)"}),"Fornecedores"]})}),e.jsx("div",{children:e.jsx(Z,{variant:"h4",children:"Criar Novo Fornecedor"})})]}),e.jsx(Ne,{})]})})]})}export{He as Page};
