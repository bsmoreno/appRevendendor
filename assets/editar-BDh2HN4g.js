import{ak as Y,G as er,al as sr,h as A,aj as tr,U as v,p as y,J as ir,t as X,an as or,ao as l,a4 as dr,ay as nr,r as k,j as r,a2 as lr,aq as cr,S as L,D as ur,T as Z,ar as d,as as c,at as u,au as N,av as M,aJ as g,I as C,aw as hr,a as xr,R as rr,aB as mr,H as pr,B as _r,ax as jr,c as fr}from"./index-BmfGJE-Y.js";import{A as vr}from"./ArrowLeft-uFTLAPnv.js";import{u as gr,B as S,S as b,w as P,T as Cr}from"./select-tipos-C0cCfiN8.js";import{N as Sr}from"./react-number-format.es-BDYcYGAq.js";import{z as i,t as br}from"./index-jjTw8nlg.js";import{u as Pr}from"./useToggle-BAApmVD4.js";import{L as yr}from"./LoadingButton-gJW1zksJ.js";import"./TableHead-5HVq-qDc.js";import"./option-3-dWwJf-.js";import"./Select-CJvL_hJA.js";const Tr=i.object({id_Produto:i.string().uuid(),cd_Produto:i.string().optional(),cd_EAN:i.string().optional(),ds_Produto:i.string().min(1,"Informe o Nome do Produto").toUpperCase(),ds_Descricao:i.string().toUpperCase().optional(),tp_Kit:i.boolean({required_error:"Informe se o produto é um Kit"}),tp_Status:i.boolean({required_error:"Informe o Status do Produto"}),id_Marca:i.string().uuid("Informe a Marca"),id_SubMarca:i.string().uuid("Informe a SubMarca").or(i.literal("")).nullish().transform(s=>{if(s==="")return null}),id_Linha:i.string().uuid("Informe a Linha").or(i.literal("")).nullish().transform(s=>{if(s==="")return null}),id_Classificacao:i.nullable(i.string().uuid("Informe a Classificação")).or(i.literal("")).nullish().transform(s=>{if(s==="")return null}),id_Caracteristica:i.nullable(i.string().uuid("Informe a Caracteristica")).or(i.literal("")).nullish().transform(s=>{if(s==="")return null}),id_Tipo:i.nullable(i.string().uuid("Informe a Tipo")).or(i.literal("")).nullish().transform(s=>{if(s==="")return null}),vl_Venda:i.number().min(.01,"Informe o Valor de Venda do Produto")}),Er=s=>{const _=Y(),[F,q]=Pr(!1),h=er(),[n,t]=sr();A.useEffect(()=>{const f=tr(dr([nr()]),s);if(s===void 0||!f.success){v.error("Id de Cliente Inválido"),h.removeQueries({queryKey:["ProdutosEditar",s],exact:!0}),_(y.dashboard.cadastros.clientes.listar);return}},[s]),gr(async()=>{await h.invalidateQueries(),q(!0)},[h]);const{data:a,isLoading:T,isFetching:B}=ir({queryKey:["ProdutosEditar",s],queryFn:async()=>{var f,j,K,z,w,D,Q,U,R,H,G,J,$,O;try{const o=await X.get("Produtos/v1/Buscar",{params:{id_Produto:s}});return o.status===200?(p({id_Produto:((f=o.data)==null?void 0:f.id_Produto)??"",cd_Produto:((j=o.data)==null?void 0:j.cd_Produto)??"",cd_EAN:((K=o.data)==null?void 0:K.cd_EAN)??"",ds_Produto:((z=o.data)==null?void 0:z.ds_Produto)??"",ds_Descricao:((w=o.data)==null?void 0:w.ds_Descricao)??"",tp_Kit:((D=o.data)==null?void 0:D.tp_Kit)??!1,id_Marca:((Q=o.data)==null?void 0:Q.id_Marca)??"",id_SubMarca:((U=o.data)==null?void 0:U.id_SubMarca)??"",id_Linha:((R=o.data)==null?void 0:R.id_Linha)??"",id_Classificacao:((H=o.data)==null?void 0:H.id_Classificacao)??"",id_Caracteristica:((G=o.data)==null?void 0:G.id_Caracteristica)??"",id_Tipo:((J=o.data)==null?void 0:J.id_Tipo)??"",vl_Venda:(($=o.data)==null?void 0:$.vl_Venda)??0,tp_Status:((O=o.data)==null?void 0:O.tp_Status)??!0}),o.data):(v.error("Produto não encontrado"),h.removeQueries({queryKey:["ProdutosEditar",s],exact:!0}),_(y.dashboard.cadastros.produtos.listar),null)}catch{return v.error("Erro ao buscar Produto"),h.removeQueries({queryKey:["ProdutosEditar",s],exact:!0}),_(y.dashboard.cadastros.produtos.listar),null}},enabled:!!s&&F}),x={id_Produto:(a==null?void 0:a.id_Produto)??"",cd_Produto:(a==null?void 0:a.cd_Produto)??"",cd_EAN:(a==null?void 0:a.cd_EAN)??"",ds_Produto:(a==null?void 0:a.ds_Produto)??"",ds_Descricao:(a==null?void 0:a.ds_Descricao)??"",tp_Kit:(a==null?void 0:a.tp_Kit)??!1,id_Marca:(a==null?void 0:a.id_Marca)??"",id_SubMarca:(a==null?void 0:a.id_SubMarca)??"",id_Linha:(a==null?void 0:a.id_Linha)??"",id_Classificacao:(a==null?void 0:a.id_Classificacao)??"",id_Caracteristica:(a==null?void 0:a.id_Caracteristica)??"",id_Tipo:(a==null?void 0:a.id_Tipo)??"",vl_Venda:(a==null?void 0:a.vl_Venda)??0,tp_Status:(a==null?void 0:a.tp_Status)??!0},{control:I,handleSubmit:m,setValue:V,reset:p,watch:W,formState:{errors:e,isSubmitting:E}}=or({mode:"onSubmit",reValidateMode:"onBlur",defaultValues:x,resolver:br(Tr,{async:!0},{mode:"async"})}),ar=A.useCallback(async f=>{try{(await X.put("/Produtos/v1/Editar",f)).status===200?(v.success("Produto Atualizado Com Sucesso!"),h.removeQueries({queryKey:["ProdutosEditar",s],exact:!0}),_(y.dashboard.cadastros.produtos.listar)):v.error("Falha ao Atualizar Cliente")}catch(j){v.error(j==null?void 0:j.message),h.removeQueries({queryKey:["ProdutosEditar",s],exact:!0})}},[]);return A.useEffect(()=>{t(E||T||B)},[E,T,B]),{Controller:l,watch:W,handleSubmit:m,setValue:V,onSubmit:ar,isSubmitting:E,errors:e,control:I,navigate:_,isFetching:B,isLoading:T}};function Mr({id_Produto:s}){const{handleSubmit:_,onSubmit:F,setValue:q,watch:h,control:n,errors:t,isLoading:a,isSubmitting:T,navigate:B}=Er(s),[x,I]=k.useState(null),[m,V]=k.useState({produto_marca:0,produto_submarca:0,produto_linha:0,produto_classificacao:0,produto_caracteristica:0,produto_tipo:0}),p=e=>{I(e),console.log("handleEditarCategoria",x)},W=()=>{x&&(V(e=>({...e,[x]:e[x]+1})),I(null))};return console.log(t),r.jsxs(r.Fragment,{children:[r.jsx("form",{onSubmit:_(F),children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsx(L,{divider:r.jsx(ur,{}),spacing:4,children:r.jsxs(L,{spacing:3,children:[r.jsx(Z,{variant:"h6",children:"Informações do Produto"}),r.jsxs(d,{container:!0,spacing:3,children:[r.jsx(d,{md:6,xs:12,children:r.jsx(l,{control:n,name:"ds_Produto",render:({field:e})=>r.jsxs(c,{error:!!t.ds_Produto,fullWidth:!0,children:[r.jsx(u,{required:!0,children:"Nome:"}),r.jsx(N,{...e,inputProps:{style:{textTransform:"uppercase"}}}),t.ds_Produto?r.jsx(M,{children:t.ds_Produto.message}):null]})})}),r.jsx(d,{md:6,xs:12,children:r.jsx(l,{control:n,name:"cd_Produto",render:({field:e})=>r.jsxs(c,{error:!!t.cd_Produto,fullWidth:!0,children:[r.jsx(u,{required:!0,children:"Cod. Produto:"}),r.jsx(N,{...e}),t.cd_Produto?r.jsx(M,{children:t.cd_Produto.message}):null]})})}),r.jsx(d,{md:6,xs:12,children:r.jsx(l,{control:n,name:"cd_EAN",render:({field:e})=>r.jsxs(c,{error:!!t.cd_EAN,fullWidth:!0,children:[r.jsx(u,{children:"EAN"}),r.jsx(N,{...e}),t.cd_EAN?r.jsx(M,{children:t.cd_EAN.message}):null]})})}),r.jsx(d,{md:6,xs:12,children:r.jsx(l,{control:n,name:"vl_Venda",render:({field:e})=>r.jsxs(c,{error:!!t.vl_Venda,fullWidth:!0,children:[r.jsx(u,{children:"Valor de Venda"}),r.jsx(Sr,{decimalScale:2,prefix:"R$ ",fixedDecimalScale:!0,allowNegative:!1,"aria-label":"vl_Credito",thousandSeparator:".",decimalSeparator:",",customInput:N,value:e.value,onValueChange:({value:E})=>{e.onChange(parseFloat(E))}}),t.vl_Venda?r.jsx(M,{children:t.vl_Venda.message}):null]})})}),r.jsx(d,{md:3,xs:12,children:r.jsx(l,{control:n,name:"id_Marca",render:({field:e})=>r.jsxs(c,{error:!!t.id_Marca,fullWidth:!0,children:[r.jsx(u,{children:"Marca"}),r.jsxs(S,{fullWidth:!0,variant:"outlined",size:"small",sx:{mt:1},children:[r.jsx(b,{variant:"outlined",dsTipo:"produto_marca",placeholder:"Selecione a Marca",updateFlag:m.produto_marca,...e}),r.jsx(g,{title:"Nova Marca",children:r.jsx(C,{onClick:()=>p("produto_marca"),children:r.jsx(P,{})})})]}),t.id_Marca?r.jsx(M,{error:!0,children:t.id_Marca.message}):null]})})}),r.jsx(d,{md:3,xs:12,children:r.jsx(l,{control:n,name:"id_SubMarca",render:({field:e})=>r.jsxs(c,{error:!!t.id_SubMarca,fullWidth:!0,children:[r.jsx(u,{children:"SubMarca"}),r.jsxs(S,{fullWidth:!0,variant:"outlined",size:"small",sx:{mt:1},children:[r.jsx(b,{variant:"outlined",dsTipo:"produto_submarca",placeholder:"Selecione a SubMarca",updateFlag:m.produto_submarca,...e}),r.jsx(g,{title:"Nova SubMarca",children:r.jsx(C,{onClick:()=>p("produto_submarca"),children:r.jsx(P,{})})})]})]})})}),r.jsx(d,{md:3,xs:12,children:r.jsx(l,{control:n,name:"id_Linha",render:({field:e})=>r.jsxs(c,{error:!!t.id_Linha,fullWidth:!0,children:[r.jsx(u,{children:"Linha"}),r.jsxs(S,{fullWidth:!0,variant:"outlined",size:"small",sx:{mt:1},children:[r.jsx(b,{variant:"outlined",dsTipo:"produto_linha",placeholder:"Selecione a Linha",updateFlag:m.produto_linha,...e}),r.jsx(g,{title:"Nova Linha",children:r.jsx(C,{onClick:()=>p("produto_linha"),children:r.jsx(P,{})})})]})]})})}),r.jsx(d,{md:3,xs:12,children:r.jsx(l,{control:n,name:"id_Classificacao",render:({field:e})=>r.jsxs(c,{error:!!t.id_Linha,fullWidth:!0,children:[r.jsx(u,{children:"Classificação"}),r.jsxs(S,{fullWidth:!0,variant:"outlined",size:"small",sx:{mt:1},children:[r.jsx(b,{variant:"outlined",dsTipo:"produto_classificacao",placeholder:"Selecione a Classificação",updateFlag:m.produto_classificacao,...e}),r.jsx(g,{title:"Nova Classificação",children:r.jsx(C,{onClick:()=>p("produto_classificacao"),children:r.jsx(P,{})})})]})]})})}),r.jsx(d,{md:3,xs:12,children:r.jsx(l,{control:n,name:"id_Caracteristica",render:({field:e})=>r.jsxs(c,{error:!!t.id_Linha,fullWidth:!0,children:[r.jsx(u,{children:"Caracteristica"}),r.jsxs(S,{fullWidth:!0,variant:"outlined",size:"small",sx:{mt:1},children:[r.jsx(b,{variant:"outlined",dsTipo:"produto_caracteristica",placeholder:"Selecione a Caracteristica",updateFlag:m.produto_caracteristica,...e}),r.jsx(g,{title:"Nova Caracteristica",children:r.jsx(C,{onClick:()=>p("produto_caracteristica"),children:r.jsx(P,{})})})]})]})})}),r.jsx(d,{md:3,xs:12,children:r.jsx(l,{control:n,name:"id_Tipo",render:({field:e})=>r.jsxs(c,{error:!!t.id_Linha,fullWidth:!0,children:[r.jsx(u,{children:"Tipo"}),r.jsxs(S,{fullWidth:!0,variant:"outlined",size:"small",sx:{mt:1},children:[r.jsx(b,{variant:"outlined",dsTipo:"produto_tipo",placeholder:"Selecione o Tipo",updateFlag:m.produto_tipo,...e}),r.jsx(g,{title:"Novo Tipo",children:r.jsx(C,{onClick:()=>p("produto_tipo"),children:r.jsx(P,{})})})]})]})})}),r.jsx(d,{md:3,xs:12}),r.jsx(d,{md:3,xs:12}),r.jsx(d,{xs:12})]})]})})}),r.jsxs(hr,{sx:{justifyContent:"flex-end"},children:[r.jsx(xr,{color:"secondary",component:rr,href:y.dashboard.cadastros.produtos.listar,children:"Cancel"}),r.jsx(yr,{type:"submit",loadingIndicator:"Salvando...",loading:T,variant:"outlined",children:"Cadastrar Produto"})]})]})}),x&&r.jsx(Cr,{ds_Tipo:x,handleCloseModal:W})]})}const Br={title:`Details | Products | Dashboard | ${fr.site.name}`};function zr(){var{id:s}=mr();return Y(),r.jsxs(k.Fragment,{children:[r.jsx(pr,{children:r.jsx("title",{children:Br.title})}),r.jsx(_r,{sx:{maxWidth:"var(--Content-maxWidth)",m:"var(--Content-margin)",p:"var(--Content-padding)",width:"var(--Content-width)"},children:r.jsxs(L,{spacing:4,children:[r.jsxs(L,{spacing:3,children:[r.jsx("div",{children:r.jsxs(jr,{color:"text.primary",component:rr,href:y.dashboard.cadastros.produtos.listar,sx:{alignItems:"center",display:"inline-flex",gap:1},variant:"subtitle2",children:[r.jsx(vr,{fontSize:"var(--icon-fontSize-md)"}),"Produtos"]})}),r.jsx("div",{children:r.jsx(Z,{variant:"h4",children:"Editar Produto"})})]}),r.jsx(Mr,{id_Produto:s})]})})]})}export{zr as Page};
