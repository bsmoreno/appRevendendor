import{t as N,ak as z,al as O,an as Z,h as k,U as S,p as w,ao as G,j as e,a2 as q,aq as K,S as I,D as Q,T as M,ar as l,as as d,at as h,au as p,av as c,aw as X,a as U,R as J,H as Y,B as P,a1 as ee,c as re}from"./index-BmfGJE-Y.js";import{N as se}from"./react-number-format.es-BDYcYGAq.js";import{s as C,Z as f,o as ne,b as A,n as ae,t as oe}from"./index-jjTw8nlg.js";import{V as R}from"./validateCPFCNPJ-DPNkBWup.js";import{M as v}from"./reactTextMask-PSz5W310.js";import{w as y}from"./WhatsappLogo-C-GNfsRi.js";import{T as B}from"./ToggleButton-DzmtCWtB.js";import{L as te}from"./LoadingButton-gJW1zksJ.js";const le=async r=>{try{return(await N.get(`/Clientes/v1/VerificarEmail?ds_Email=${encodeURIComponent(r)}`)).data}catch{return!1}},ie=async r=>{try{return r=r.replace(/[\D]/g,""),r==="00000000000"||r==="00000000000000"?!0:(await N.get(`/Clientes/v1/VerificarCpfCnpj?cd_CpfCnpj=${r}`)).data}catch(t){return console.log("Valida CPF/CNPJ Erro",t),!1}},E=r=>{if(r==null)return!0;var t=r.replace(/[\D]/g,"");return t===""?!0:!(t.length<10||t.length>11)},V=C().min(11,"CPF Inválido").superRefine((r,t)=>{if(r=r.replace(/[\D]/g,""),r==="00000000000"||r==="00000000000000")return!0;r.length<11?t.addIssue({code:f.custom,message:"CPF Inválido"}):r.length==11?R.isCPF(r)||t.addIssue({code:f.custom,message:"CPF Incorreto"}):r.length>11&&r.length<14?t.addIssue({code:f.custom,message:"CNPJ Inválido"}):r.length==14?R.isCNPJ(r)||t.addIssue({code:f.custom,message:"CNPJ Incorreto"}):t.addIssue({code:f.custom,message:"CPF/CNPJ Inválido"})}),D=C({required_error:"Informe o E-mail"}).min(1,"Informe o E-mail").max(255,"Máximo de 255 Caracteres").email("E-mail Inválido").toLowerCase(),de=ne({cd_CpfCnpj:V,ds_Nome:C({required_error:"Informe o Nome"}).min(1,"Informe o Nome").max(255,"Máximo de 255 Caracteres").toUpperCase(),ds_Sobrenome:C({required_error:"Informe o Sobrenome"}).min(1,"Informe o Sobrenome").max(255,"Máximo de 255 Caracteres").toUpperCase(),ds_Apelido:C().min(1,"Informe o Apelido").max(255,"Máximo de 255 Caracteres").toUpperCase().optional(),ds_Email:D,nr_Telefone:C().refine(r=>E(r),"Telefone Inválido").optional(),tp_TelefoneWhatsApp:A().optional(),nr_Celular:C().refine(r=>E(r),"Celular Inválido").optional(),tp_CelularWhatsApp:A().optional(),nr_Contato:C().refine(r=>E(r),"Contato Inválido").optional(),tp_ContatoWhatsApp:A().optional(),vl_Credito:ae({required_error:"Informe o Valor de Crédito"}).positive().min(.01,"Valor Minimo de R$ 0,00").finite()}).superRefine(async(r,t)=>{if((await D.safeParseAsync(r.ds_Email)).success&&(await le(r.ds_Email)||t.addIssue({code:f.custom,message:"E-mail já cadastrado!",path:["ds_Email"]})),(await V.safeParseAsync(r.cd_CpfCnpj)).success&&!await ie(r.cd_CpfCnpj)){let j=r.cd_CpfCnpj.replace(/[\D]/g,"").length<=11?"CPF":"CNPJ";t.addIssue({code:f.custom,message:`${j} já cadastrado!`,path:["cd_CpfCnpj"]})}}),ce=()=>{const r=z(),[t,u]=O(),j={cd_CpfCnpj:"000.000.000-00",ds_Nome:"",ds_Sobrenome:"",ds_Apelido:"",ds_Email:"",nr_Telefone:"",tp_TelefoneWhatsApp:!1,nr_Celular:"",tp_CelularWhatsApp:!1,nr_Contato:"",tp_ContatoWhatsApp:!1,vl_Credito:0},{control:x,handleSubmit:a,watch:i,trigger:F,setError:b,setValue:g,clearErrors:T,formState:{errors:s,isLoading:n,isValidating:o,isSubmitting:m}}=Z({mode:"onSubmit",reValidateMode:"onBlur",defaultValues:j,resolver:oe(de)}),L=k.useCallback(async _=>{try{(await N.post("/Clientes/v1/Criar",_)).status===200?(S.success("Clientes Cadastrado Com Sucesso!"),r(w.dashboard.cadastros.clientes.listar)):S.error("Falha ao Criar Cliente")}catch{S.error("Something went wrong!")}},[r]),$=_=>_.replace(/\D/g,"").length>10?["(",/\d/,/\d/,")"," ",/\d/,".",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]:["(",/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/],H=_=>_.replace(/\D/g,"").length<=11?[/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"-",/\d/,/\d/]:[/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/];return k.useEffect(()=>{u(m||n)},[m,n]),{Controller:G,handleSubmit:a,onSubmit:L,setError:b,setValue:g,clearErrors:T,watch:i,control:x,errors:s,defaultValues:j,isLoading:n,isValidating:o,isSubmitting:m,navigate:r,maskTelefone:$,maskCpfCnpj:H}};function ue(){var{Controller:r,handleSubmit:t,setValue:u,onSubmit:j,watch:x,errors:a,control:i,isSubmitting:F,navigate:b,maskTelefone:g,maskCpfCnpj:T}=ce();return e.jsx("form",{onSubmit:t(j),children:e.jsxs(q,{children:[e.jsx(K,{children:e.jsx(I,{divider:e.jsx(Q,{}),spacing:4,children:e.jsxs(I,{spacing:3,children:[e.jsx(M,{variant:"h6",children:"Informações Basicas"}),e.jsx(l,{container:!0,spacing:2,children:e.jsx(l,{md:4,xsOffset:0,xs:12,children:e.jsx(r,{control:i,name:"cd_CpfCnpj",rules:{maxLength:14},render:({field:s})=>e.jsxs(d,{error:!!a.cd_CpfCnpj,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"CPF/CNPJ"}),e.jsx(v,{value:s.value,mask:T,keepCharPositions:!0,guide:!1,render:(n,o)=>e.jsx(p,{inputRef:n,ref:s.ref,...o}),onChange:n=>{s.onChange(n)},onBlur:n=>{s.onBlur()}}),a.cd_CpfCnpj?e.jsx(c,{children:a.cd_CpfCnpj.message}):null]})})})}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{md:6,xs:12,children:e.jsx(r,{control:i,name:"ds_Nome",render:({field:s})=>e.jsxs(d,{error:!!a.ds_Nome,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"Nome"}),e.jsx(p,{inputProps:{style:{textTransform:"uppercase"}},...s}),a.ds_Nome?e.jsx(c,{children:a.ds_Nome.message}):null]})})}),e.jsx(l,{md:6,xs:12,children:e.jsx(r,{control:i,name:"ds_Sobrenome",render:({field:s})=>e.jsxs(d,{error:!!a.ds_Sobrenome,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"Sobrenome"}),e.jsx(p,{inputProps:{style:{textTransform:"uppercase"}},...s}),a.ds_Sobrenome?e.jsx(c,{children:a.ds_Sobrenome.message}):null]})})}),e.jsx(l,{md:6,xs:12,children:e.jsx(r,{control:i,name:"ds_Apelido",render:({field:s})=>e.jsxs(d,{error:!!a.ds_Apelido,fullWidth:!0,children:[e.jsx(h,{children:"Apelido"}),e.jsx(p,{inputProps:{style:{textTransform:"uppercase"}},...s}),a.ds_Apelido?e.jsx(c,{children:a.ds_Apelido.message}):null]})})}),e.jsx(l,{md:6,xs:12,children:e.jsx(r,{control:i,name:"ds_Email",render:({field:s})=>e.jsxs(d,{error:!!a.ds_Email,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"E-mail"}),e.jsx(p,{...s,inputProps:{style:{textTransform:"lowercase"}},onChange:n=>{s.onChange(n)}}),a.ds_Email?e.jsx(c,{children:a.ds_Email.message}):null]})})}),e.jsx(l,{md:6,xs:12,children:e.jsxs(l,{container:!0,spacing:1,children:[e.jsx(l,{xs:!0,children:e.jsx(r,{control:i,name:"nr_Celular",render:({field:s})=>e.jsxs(d,{error:!!a.nr_Celular,fullWidth:!0,children:[e.jsx(h,{children:"Celular"}),e.jsx(v,{value:s.value,mask:g,keepCharPositions:!0,guide:!1,render:(n,o)=>e.jsx(p,{inputRef:n,ref:s.ref,...o}),onChange:n=>{var o;s.onChange(n.target.value),((o=n==null?void 0:n.target)==null?void 0:o.value.length)===0&&u("tp_CelularWhatsApp",!1)}}),a.nr_Celular?e.jsx(c,{children:a.nr_Celular.message}):null]})})}),e.jsx(l,{xs:6,sx:{display:"flex",alignContent:"end",alignItems:"end"},children:e.jsx(r,{control:i,name:"tp_CelularWhatsApp",render:({field:s})=>{var n,o;return e.jsxs(d,{error:!!a.tp_CelularWhatsApp,fullWidth:!0,children:[e.jsx(B,{...s,color:"success",disabled:((n=x("nr_Celular"))==null?void 0:n.length)==0,selected:((o=x("nr_Celular"))==null?void 0:o.length)==0?!1:s.value,onChange:m=>{s.onChange(m),u(s.name,!s.value)},children:e.jsx(y,{color:"green",size:27})}),a.nr_Celular?e.jsx(c,{children:" "}):null,"                                                        "]})}})})]})}),e.jsx(l,{md:6,xs:12,children:e.jsxs(l,{container:!0,spacing:1,children:[e.jsx(l,{xs:!0,children:e.jsx(r,{control:i,name:"nr_Telefone",render:({field:s})=>e.jsxs(d,{error:!!a.nr_Telefone,fullWidth:!0,children:[e.jsx(h,{children:"Telefone"}),e.jsx(v,{value:s.value,mask:g,keepCharPositions:!0,guide:!1,render:(n,o)=>e.jsx(p,{inputRef:n,ref:s.ref,...o}),onChange:n=>{var o;s.onChange(n.target.value),((o=n==null?void 0:n.target)==null?void 0:o.value.length)===0&&u("tp_TelefoneWhatsApp",!1)}}),a.nr_Telefone?e.jsx(c,{children:a.nr_Telefone.message}):null]})})}),e.jsx(l,{xs:6,sx:{display:"flex",alignContent:"end",alignItems:"end"},children:e.jsx(r,{control:i,name:"tp_TelefoneWhatsApp",render:({field:s})=>{var n,o;return e.jsxs(d,{error:!!a.tp_TelefoneWhatsApp,fullWidth:!0,children:[e.jsx(B,{...s,color:"success",disabled:((n=x("nr_Telefone"))==null?void 0:n.length)==0,selected:((o=x("nr_Telefone"))==null?void 0:o.length)==0?!1:s.value,onChange:m=>{s.onChange(m),u(s.name,!s.value)},children:e.jsx(y,{color:"green",size:27})}),a.nr_Telefone?e.jsx(c,{children:" "}):null]})}})})]})}),e.jsx(l,{md:6,xs:12,children:e.jsxs(l,{container:!0,spacing:1,children:[e.jsx(l,{xs:!0,children:e.jsx(r,{control:i,name:"nr_Contato",render:({field:s})=>e.jsxs(d,{error:!!a.nr_Contato,fullWidth:!0,children:[e.jsx(h,{children:"Contato"}),e.jsx(v,{value:s.value,mask:g,keepCharPositions:!0,guide:!1,render:(n,o)=>e.jsx(p,{inputRef:n,ref:s.ref,...o}),onChange:n=>{var o;s.onChange(n.target.value),((o=n==null?void 0:n.target)==null?void 0:o.value.length)===0&&u("tp_ContatoWhatsApp",!1)}}),a.nr_Contato?e.jsx(c,{children:a.nr_Contato.message}):null]})})}),e.jsx(l,{xs:6,sx:{display:"flex",alignContent:"end",alignItems:"end"},children:e.jsx(r,{control:i,name:"tp_ContatoWhatsApp",render:({field:s})=>{var n,o;return e.jsxs(d,{error:!!a.tp_ContatoWhatsApp,fullWidth:!0,children:[e.jsx(B,{...s,color:"success",disabled:((n=x("nr_Contato"))==null?void 0:n.length)==0,selected:((o=x("nr_Contato"))==null?void 0:o.length)==0?!1:s.value,onChange:m=>{s.onChange(m),u(s.name,!s.value)},children:e.jsx(y,{color:"green",size:27})}),a.nr_Contato?e.jsx(c,{children:" "}):null]})}})})]})}),e.jsx(l,{md:6,xs:12,children:e.jsx(r,{control:i,name:"vl_Credito",render:({field:s})=>e.jsxs(d,{error:!!a.vl_Credito,fullWidth:!0,children:[e.jsx(h,{children:"Crédito"}),e.jsx(se,{decimalScale:2,prefix:"R$ ",fixedDecimalScale:!0,allowNegative:!1,"aria-label":"vl_Credito",thousandSeparator:".",decimalSeparator:",",customInput:p,value:s.value,onValueChange:({value:n})=>{s.onChange(parseFloat(n))}}),a.vl_Credito?e.jsx(c,{children:a.vl_Credito.message}):null]})})})]})]})})}),e.jsxs(X,{sx:{justifyContent:"flex-end"},children:[e.jsx(U,{color:"secondary",component:J,onClick:()=>{b(w.dashboard.cadastros.clientes.listar)},children:"Cancelar"}),e.jsx(te,{type:"submit",loadingIndicator:"Salvando...",loading:F,variant:"outlined",children:"Cadastrar Cliente"})]})]})})}const me={title:`Clientes | Dashboard | ${re.site.name}`};function ve(){return e.jsxs(k.Fragment,{children:[e.jsx(Y,{children:e.jsx("title",{children:me.title})}),e.jsx(P,{sx:{maxWidth:"var(--Content-maxWidth)",m:"var(--Content-margin)",p:"var(--Content-padding)",width:"var(--Content-width)"},children:e.jsxs(I,{spacing:4,children:[e.jsxs(I,{direction:{xs:"column",sm:"row"},spacing:4,sx:{alignItems:"flex-start"},children:[e.jsx(P,{sx:{flex:"1 1 auto"},children:e.jsx(M,{variant:"h4",children:"Clientes"})}),e.jsx(P,{children:e.jsx(U,{component:J,href:w.dashboard.cadastros.clientes.criar,startIcon:e.jsx(ee,{}),variant:"contained",children:"Novo"})})]}),e.jsx(q,{children:e.jsx(ue,{})})]})})]})}export{ve as Page};
