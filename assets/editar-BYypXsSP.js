import{t as W,ak as J,h as _,G as K,al as H,aj as O,U as g,p as v,J as G,an as Z,ao as X,a4 as Y,ay as ee,j as e,a2 as re,aq as se,S as A,D as ne,T as M,ar as l,as as u,at as h,au as C,av as m,aw as ae,a as te,R as oe,aB as le,H as ie,B,ax as de,c as ce}from"./index-BmfGJE-Y.js";import{A as ue}from"./ArrowLeft-uFTLAPnv.js";import{s as x,Z as f,o as me,b as S,n as pe,t as he}from"./index-jjTw8nlg.js";import{V as D}from"./validateCPFCNPJ-DPNkBWup.js";import{M as T}from"./reactTextMask-PSz5W310.js";import{w as F}from"./WhatsappLogo-C-GNfsRi.js";import{N as Ce}from"./react-number-format.es-BDYcYGAq.js";import{F as xe}from"./FormControlLabel-HCwVRRhk.js";import{S as fe}from"./Switch-DCD6GBbn.js";import{T as N}from"./ToggleButton-DzmtCWtB.js";import{L as je}from"./LoadingButton-gJW1zksJ.js";import"./SwitchBase-LEr907X7.js";const ge=async(s,a)=>{try{return(await W.get(`/Clientes/v1/VerificarEmail?ds_Email=${encodeURIComponent(s)}&id_Cliente=${a}`)).data}catch(d){return console.log("Valida E-mail Erro",d),!1}},_e=async(s,a)=>{try{return s=s.replace(/[\D]/g,""),s==="00000000000"||s==="00000000000000"?!0:(await W.get(`/Clientes/v1/VerificarCpfCnpj?cd_CpfCnpj=${s}&id_Cliente=${a}`)).data}catch(d){return console.log("Valida CPF/CNPJ Erro",d),!1}},w=s=>{if(s==null)return!0;let a=s.replace(/[\D]/g,"");return a===""?!0:!(a.length<10||a.length>11)},L=x().min(11,"CPF Inválido").superRefine((s,a)=>{if(s=s.replace(/[\D]/g,""),s==="00000000000"||s==="00000000000000")return!0;s.length<11?a.addIssue({code:f.custom,message:"CPF Inválido"}):s.length==11?D.isCPF(s)||a.addIssue({code:f.custom,message:"CPF Incorreto"}):s.length>11&&s.length<14?a.addIssue({code:f.custom,message:"CNPJ Inválido"}):s.length==14?D.isCNPJ(s)||a.addIssue({code:f.custom,message:"CNPJ Incorreto"}):a.addIssue({code:f.custom,message:"CPF/CNPJ Inválido"})}),U=x({required_error:"Informe o E-mail"}).min(1,"Informe o E-mail").max(255,"Máximo de 255 Caracteres").email("E-mail Inválido").toLowerCase(),ve=me({id_Cliente:x().uuid(),cd_CpfCnpj:L,ds_Nome:x().min(1,"Informe o Nome").max(255,"Máximo de 255 Caracteres").toUpperCase(),ds_Sobrenome:x().min(1,"Informe o Nome").max(255,"Máximo de 255 Caracteres").toUpperCase(),ds_Apelido:x().min(1,"Informe o Nome").max(255,"Máximo de 255 Caracteres").toUpperCase().optional(),ds_Email:U,nr_Telefone:x().refine(s=>w(s),"Telefone Inválido").optional(),tp_TelefoneWhatsApp:S().optional(),nr_Celular:x().refine(s=>w(s),"Celular Inválido").optional(),tp_CelularWhatsApp:S().optional(),nr_Contato:x().refine(s=>w(s),"Contato Inválido").optional(),tp_ContatoWhatsApp:S().optional(),vl_Credito:pe().positive().min(.01,"Valor Minimo de R$ 0,00").finite(),tp_Status:S({required_error:"Informe o Status"})}).superRefine(async(s,a)=>{if((await U.safeParseAsync(s.ds_Email)).success&&(await ge(s.ds_Email,s.id_Cliente)||a.addIssue({code:f.custom,message:"E-mail já cadastrado!",path:["ds_Email"]})),(await L.safeParseAsync(s.cd_CpfCnpj)).success&&!await _e(s.cd_CpfCnpj,s.id_Cliente)){let y=s.cd_CpfCnpj.replace(/[\D]/g,"").length<=11?"CPF":"CNPJ";a.addIssue({code:f.custom,message:`${y} já cadastrado!`,path:["cd_CpfCnpj"]})}}),ye=s=>{const a=J(),[d,y]=_.useState(),p=K(),[q,P]=H();_.useEffect(()=>{console.log("aqui");const c=O(Y([ee()]),s);if(s===void 0||!c.success){g.error("Id de Cliente Inválido"),p.removeQueries({queryKey:["ClientesEditar",s],exact:!0}),a(v.dashboard.cadastros.clientes.listar);return}},[s]);const{data:r,isLoading:i,isFetching:I}=G({queryKey:["ClientesEditar",s],queryFn:async()=>{try{const c=await W.get("Clientes/v1/Buscar",{params:{id_Cliente:s}});return c.status===200?(y(c.data),n(c.data),c.data):(g.error("Usuário não encontrado"),p.removeQueries({queryKey:["ClientesEditar",s],exact:!0}),a(v.dashboard.cadastros.clientes.listar),null)}catch{return g.error("Erro ao buscar usuário"),p.removeQueries({queryKey:["ClientesEditar",s],exact:!0}),a(v.dashboard.cadastros.clientes.listar),null}},enabled:!!s,refetchOnWindowFocus:!1});_.useEffect(()=>{i&&n(d)},[i]);const R={id_Cliente:(r==null?void 0:r.id_Cliente)??"",cd_CpfCnpj:(r==null?void 0:r.cd_CpfCnpj)??"",ds_Nome:(r==null?void 0:r.ds_Nome)??"",ds_Sobrenome:(r==null?void 0:r.ds_Sobrenome)??"",ds_Email:(r==null?void 0:r.ds_Email)??"",vl_Credito:(r==null?void 0:r.vl_Credito)??0,ds_Apelido:(r==null?void 0:r.ds_Apelido)??"",nr_Telefone:(r==null?void 0:r.nr_Telefone)??"",tp_TelefoneWhatsApp:(r==null?void 0:r.tp_TelefoneWhatsApp)??!1,nr_Celular:(r==null?void 0:r.nr_Celular)??"",tp_CelularWhatsApp:(r==null?void 0:r.tp_CelularWhatsApp)??!1,nr_Contato:(r==null?void 0:r.nr_Contato)??"",tp_ContatoWhatsApp:(r==null?void 0:r.tp_ContatoWhatsApp)??!1,tp_Status:(r==null?void 0:r.tp_Status)??!1},{control:V,handleSubmit:k,setValue:b,reset:n,watch:t,formState:{errors:o,isSubmitting:E}}=Z({mode:"onSubmit",reValidateMode:"onBlur",defaultValues:R,resolver:he(ve,{async:!0},{mode:"async"})}),$=_.useCallback(async c=>{try{(await W.put("/Clientes/v1/Editar",c)).status===200?(g.success("Cliente Atualizado Com Sucesso!"),p.removeQueries({queryKey:["ClientesEditar",s],exact:!0}),a(v.dashboard.cadastros.clientes.listar)):g.error("Falha ao Atualizar Cliente")}catch(j){g.error(j==null?void 0:j.message),p.removeQueries({queryKey:["ClientesEditar",s],exact:!0})}},[]),z=c=>c.replace(/\D/g,"").length>10?["(",/\d/,/\d/,")"," ",/\d/,".",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]:["(",/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/],Q=c=>c.replace(/\D/g,"").length<=11?[/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"-",/\d/,/\d/]:[/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/];return _.useEffect(()=>{P(E||i||I)},[E,i,I]),{Controller:X,watch:t,maskTelefone:z,maskCpfCnpj:Q,handleSubmit:k,setValue:b,onSubmit:$,isSubmitting:E,errors:o,control:V,navigate:a,isFetching:I,isLoading:i}};function Ie({id_Cliente:s}){var{Controller:a,watch:d,handleSubmit:y,setValue:p,onSubmit:q,isSubmitting:P,errors:r,control:i,navigate:I,isFetching:R,isLoading:V,maskCpfCnpj:k,maskTelefone:b}=ye(s);return e.jsx("form",{onSubmit:y(q),children:e.jsxs(re,{children:[e.jsx(se,{children:e.jsx(A,{divider:e.jsx(ne,{}),spacing:4,children:e.jsxs(A,{spacing:3,children:[e.jsx(M,{variant:"h6",children:"Informações Basicas"}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{md:4,xs:!0,children:e.jsx(a,{control:i,name:"cd_CpfCnpj",rules:{maxLength:14},render:({field:n})=>e.jsxs(u,{error:!!r.cd_CpfCnpj,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"CPF/CNPJ"}),e.jsx(T,{value:n.value,mask:k,keepCharPositions:!0,guide:!1,render:(t,o)=>e.jsx(C,{inputRef:t,ref:n.ref,...o}),onChange:n.onChange}),r.cd_CpfCnpj?e.jsx(m,{children:r.cd_CpfCnpj.message}):null]})})}),e.jsx(l,{mdOffset:6}),e.jsx(l,{md:!0,xs:!0,children:e.jsx(a,{control:i,name:"tp_Status",render:({field:n})=>e.jsxs(u,{error:!!r.cd_CpfCnpj,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"Status"}),e.jsx(xe,{control:e.jsx(fe,{checked:n.value,...n,color:n.value?"success":"error"}),label:n.value?"Ativo":"Inativo"}),r.cd_CpfCnpj?e.jsx(m,{children:r.cd_CpfCnpj.message}):null]})})})]}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{md:6,xs:12,children:e.jsx(a,{control:i,name:"ds_Nome",render:({field:n})=>e.jsxs(u,{error:!!r.ds_Nome,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"Nome"}),e.jsx(C,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_Nome?e.jsx(m,{children:r.ds_Nome.message}):null]})})}),e.jsx(l,{md:6,xs:12,children:e.jsx(a,{control:i,name:"ds_Sobrenome",render:({field:n})=>e.jsxs(u,{error:!!r.ds_Sobrenome,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"Sobrenome"}),e.jsx(C,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_Sobrenome?e.jsx(m,{children:r.ds_Sobrenome.message}):null]})})}),e.jsx(l,{md:6,xs:12,children:e.jsx(a,{control:i,name:"ds_Apelido",render:({field:n})=>e.jsxs(u,{error:!!r.ds_Apelido,fullWidth:!0,children:[e.jsx(h,{children:"Apelido"}),e.jsx(C,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_Apelido?e.jsx(m,{children:r.ds_Apelido.message}):null]})})}),e.jsx(l,{md:6,xs:12,children:e.jsx(a,{control:i,name:"ds_Email",render:({field:n})=>e.jsxs(u,{error:!!r.ds_Email,fullWidth:!0,children:[e.jsx(h,{required:!0,children:"E-mail"}),e.jsx(C,{...n,inputProps:{style:{textTransform:"lowercase"}}}),r.ds_Email?e.jsx(m,{children:r.ds_Email.message}):null]})})}),e.jsx(l,{md:6,xs:12,children:e.jsxs(l,{container:!0,spacing:1,children:[e.jsx(l,{xs:!0,children:e.jsx(a,{control:i,name:"nr_Celular",render:({field:n})=>e.jsxs(u,{error:!!r.nr_Celular,fullWidth:!0,children:[e.jsx(h,{children:"Celular"}),e.jsx(T,{value:n.value,mask:b,keepCharPositions:!0,guide:!1,render:(t,o)=>e.jsx(C,{inputRef:t,ref:n.ref,...o}),onChange:t=>{var o;n.onChange(t.target.value),((o=t==null?void 0:t.target)==null?void 0:o.value.length)===0&&p("tp_CelularWhatsApp",!1)}}),r.nr_Celular?e.jsx(m,{children:r.nr_Celular.message}):null]})})}),e.jsx(l,{xs:6,sx:{display:"flex",alignContent:"end",alignItems:"end"},children:e.jsx(a,{control:i,name:"tp_CelularWhatsApp",render:({field:n})=>{var t,o;return e.jsxs(u,{error:!!r.tp_CelularWhatsApp,fullWidth:!0,children:[e.jsx(N,{...n,color:"success",disabled:((t=d("nr_Celular"))==null?void 0:t.length)==0,selected:((o=d("nr_Celular"))==null?void 0:o.length)==0?!1:n.value,onChange:E=>{n.onChange(),p(n.name,!n.value)},children:e.jsx(F,{color:"green",size:27})}),r.nr_Celular?e.jsx(m,{children:" "}):null,"                                                        "]})}})})]})}),e.jsx(l,{md:6,xs:12,children:e.jsxs(l,{container:!0,spacing:1,children:[e.jsx(l,{xs:!0,children:e.jsx(a,{control:i,name:"nr_Telefone",render:({field:n})=>e.jsxs(u,{error:!!r.nr_Telefone,fullWidth:!0,children:[e.jsx(h,{children:"Telefone"}),e.jsx(T,{value:n.value,mask:b,keepCharPositions:!0,guide:!1,render:(t,o)=>e.jsx(C,{inputRef:t,ref:n.ref,...o}),onChange:t=>{var o;n.onChange(t.target.value),((o=t==null?void 0:t.target)==null?void 0:o.value.length)===0&&p("tp_TelefoneWhatsApp",!1)}}),r.nr_Telefone?e.jsx(m,{children:r.nr_Telefone.message}):null]})})}),e.jsx(l,{xs:6,sx:{display:"flex",alignContent:"end",alignItems:"end"},children:e.jsx(a,{control:i,name:"tp_TelefoneWhatsApp",render:({field:n})=>{var t,o;return e.jsxs(u,{error:!!r.tp_TelefoneWhatsApp,fullWidth:!0,children:[e.jsx(N,{...n,color:"success",disabled:((t=d("nr_Telefone"))==null?void 0:t.length)==0,selected:((o=d("nr_Telefone"))==null?void 0:o.length)==0?!1:n.value,onChange:E=>{n.onChange(),p(n.name,!n.value)},children:e.jsx(F,{color:"green",size:27})}),r.nr_Telefone?e.jsx(m,{children:" "}):null]})}})})]})}),e.jsx(l,{md:6,xs:12,children:e.jsxs(l,{container:!0,spacing:1,children:[e.jsx(l,{xs:!0,children:e.jsx(a,{control:i,name:"nr_Contato",render:({field:n})=>e.jsxs(u,{error:!!r.nr_Contato,fullWidth:!0,children:[e.jsx(h,{children:"Contato"}),e.jsx(T,{value:n.value,mask:b,keepCharPositions:!0,guide:!1,render:(t,o)=>e.jsx(C,{inputRef:t,ref:n.ref,...o}),onChange:t=>{var o;n.onChange(t.target.value),((o=t==null?void 0:t.target)==null?void 0:o.value.length)===0&&p("tp_ContatoWhatsApp",!1)}}),r.nr_Contato?e.jsx(m,{children:r.nr_Contato.message}):null]})})}),e.jsx(l,{xs:6,sx:{display:"flex",alignContent:"end",alignItems:"end"},children:e.jsx(a,{control:i,name:"tp_ContatoWhatsApp",render:({field:n})=>{var t,o;return e.jsxs(u,{error:!!r.tp_ContatoWhatsApp,fullWidth:!0,children:[e.jsx(N,{...n,color:"success",disabled:((t=d("nr_Contato"))==null?void 0:t.length)==0,selected:((o=d("nr_Contato"))==null?void 0:o.length)==0?!1:n.value,onChange:()=>{n.onChange(),p(n.name,!n.value)},children:e.jsx(F,{color:"green",size:27})}),r.nr_Contato?e.jsx(m,{children:" "}):null]})}})})]})}),e.jsx(l,{md:6,xs:12,children:e.jsx(a,{control:i,name:"vl_Credito",render:({field:n})=>e.jsxs(u,{error:!!r.vl_Credito,fullWidth:!0,children:[e.jsx(h,{children:"Crédito"}),e.jsx(Ce,{decimalScale:2,prefix:"R$ ",fixedDecimalScale:!0,allowNegative:!1,"aria-label":"vl_Credito",thousandSeparator:".",decimalSeparator:",",customInput:C,value:n.value,onValueChange:({value:t})=>{n.onChange(parseFloat(t))}}),r.vl_Credito?e.jsx(m,{children:r.vl_Credito.message}):null]})})})]})]})})}),e.jsxs(ae,{sx:{justifyContent:"flex-end"},children:[e.jsx(te,{color:"secondary",component:oe,onClick:()=>{I(v.dashboard.cadastros.clientes.listar)},children:"Cancelar"}),e.jsx(je,{type:"submit",loadingIndicator:"Salvando...",loading:P,variant:"outlined",children:"Cadastrar Cliente"})]})]})})}const be={title:`Clientes | Dashboard | ${ce.site.name}`};function Re(){var{id:s}=le();const a=J();return e.jsxs(_.Fragment,{children:[e.jsx(ie,{children:e.jsx("title",{children:be.title})}),e.jsx(B,{sx:{maxWidth:"var(--Content-maxWidth)",m:"var(--Content-margin)",p:"var(--Content-padding)",width:"var(--Content-width)"},children:e.jsx(A,{spacing:4,children:e.jsxs(A,{spacing:3,children:[e.jsx(B,{children:e.jsxs(de,{color:"text.primary",onClick:()=>{a(v.dashboard.cadastros.clientes.listar)},sx:{alignItems:"center",display:"inline-flex",gap:1},variant:"subtitle2",children:[e.jsx(ue,{fontSize:"var(--icon-fontSize-md)"}),"Clientes"]})}),e.jsx(B,{children:e.jsx(M,{variant:"h4",children:"Editar Usuário"})}),e.jsx(Ie,{id_Cliente:s})]})})})]})}export{Re as Page};
