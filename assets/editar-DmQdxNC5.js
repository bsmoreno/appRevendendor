import{t as L,G as he,al as pe,ak as ae,an as je,J as re,U as g,p as B,h as W,ch as fe,ao as Ce,j as e,a2 as _e,aq as ge,S as b,D as ve,T as oe,ar as t,as as l,at as i,au as u,av as c,I as Ee,aZ as N,aw as Fe,a as ye,R as te,aB as Ie,r as Pe,H as Be,B as Se,ax as Ue,c as be}from"./index-BmfGJE-Y.js";import{A as ke}from"./ArrowLeft-uFTLAPnv.js";import{s as m,Z as F,c as f,o as Te,n as Re,u as we,b as We,t as Ne}from"./index-jjTw8nlg.js";import{V as se}from"./validateCPFCNPJ-DPNkBWup.js";import{M as P}from"./reactTextMask-PSz5W310.js";import{w as qe,A as Le}from"./autocompletecidades-Ccxhvhck.js";import{S as De}from"./Select-CJvL_hJA.js";import{L as Me}from"./LoadingButton-gJW1zksJ.js";const ze=async s=>{try{return s=s.replace(/[\D]/g,""),s==="00000000000"||s==="00000000000000"?!0:(await L.get(`/Clientes/v1/VerificarCpfCnpj?cd_CpfCnpj=${s}`)).data}catch(a){return console.log("Valida CPF/CNPJ Erro",a),!1}},q=s=>{if(s==null)return!0;var a=s.replace(/[\D]/g,"");return a===""?!0:!(a.length<10||a.length>11)},ne=m().min(11,"CPF Inválido").superRefine((s,a)=>{if(s=s.replace(/[\D]/g,""),s==="00000000000"||s==="00000000000000")return!0;s.length<11?a.addIssue({code:F.custom,message:"CPF Inválido"}):s.length==11?se.isCPF(s)||a.addIssue({code:F.custom,message:"CPF Incorreto"}):s.length>11&&s.length<14?a.addIssue({code:F.custom,message:"CNPJ Inválido"}):s.length==14?se.isCNPJ(s)||a.addIssue({code:F.custom,message:"CNPJ Incorreto"}):a.addIssue({code:F.custom,message:"CPF/CNPJ Inválido"})}),Ve=f(m().superRefine((s,a)=>{if(s=s.replace(/[\D]/g,""),s===""||s==="0".repeat(s.length))return!0})),Ae=f(m({required_error:"Informe o E-mail"}).min(1,"Informe o E-mail").max(255,"Máximo de 255 Caracteres").email("E-mail Inválido").toLowerCase()),Je=Te({id_Fornecedor:m().uuid(),nr_Fornecedor:Re(),cd_CpfCnpj:ne,cd_IE:Ve,ds_RazaoSocial:m({required_error:"Informe a Razão Social"}).min(1,"Informe a Razão Social").max(255,"Máximo de 255 Caracteres").toUpperCase(),ds_NomeFantasia:m({required_error:"Informe o Nome Fantasia"}).min(1,"Informe o Nome Fantasia").max(255,"Máximo de 255 Caracteres").toUpperCase(),ds_Email:Ae,cd_CEP:f(m().min(8,"Cep Inválido").toUpperCase()),ds_Endereco:f(m().max(255,"Máximo de 255 Caracteres").toUpperCase()),nr_Endereco:f(m().max(255,"Máximo de 255 Caracteres").toUpperCase()),ds_Bairro:f(m().max(255,"Máximo de 255 Caracteres").toUpperCase()),ds_Complemento:f(m().max(255,"Máximo de 255 Caracteres").toUpperCase()),ds_Cidade:f(we().transform(s=>{var a;return(a=s.cidade)==null?void 0:a.toUpperCase()})),cd_UF:f(m().max(255,"Máximo de 255 Caracteres").toUpperCase()),nr_Telefone:m().refine(s=>q(s),"Telefone Inválido").optional(),nr_Celular:m().refine(s=>q(s),"Celular Inválido").optional(),nr_Contato:m().refine(s=>q(s),"Contato Inválido").optional(),tp_Status:We({required_error:"Informe o Status"})}).superRefine(async(s,a)=>{if((await ne.safeParseAsync(s.cd_CpfCnpj)).success&&!await ze(s.cd_CpfCnpj)){let C=s.cd_CpfCnpj.replace(/[\D]/g,"").length<=11?"CPF":"CNPJ";a.addIssue({code:F.custom,message:`${C} já cadastrado!`,path:["cd_CpfCnpj"]})}}),Ke=s=>{const a=he(),[k,C]=pe(),_=ae(),S={id_Fornecedor:"",nr_Fornecedor:0,cd_CpfCnpj:"000.000.000-00",cd_IE:"",ds_RazaoSocial:"",ds_NomeFantasia:"",ds_Email:"",ds_Endereco:"",nr_Endereco:"",ds_Bairro:"",ds_Complemento:"",ds_Cidade:{cidade:"",uf:""},cd_UF:"",nr_Telefone:"",nr_Celular:"",nr_Contato:"",tp_Status:!1},{control:T,handleSubmit:D,watch:r,setError:d,setValue:j,setFocus:y,getValues:v,clearErrors:R,reset:U,formState:{errors:n,isLoading:o,isValidating:x,isSubmitting:w}}=je({mode:"onSubmit",reValidateMode:"onBlur",defaultValues:S,resolver:Ne(Je)}),{data:I,isLoading:M,isFetching:z}=re({queryKey:["FornecedoresEditar",s],queryFn:async()=>{try{const h=await L.get("Fornecedores/v1/Buscar",{params:{id_Fornecedor:s}});return h.status===200?h.data:(g.error("Usuário não encontrado"),a.removeQueries({queryKey:["FornecedoresEditar",s],exact:!0}),_(B.dashboard.cadastros.fornecedores.listar),null)}catch{return g.error("Erro ao buscar usuário"),a.removeQueries({queryKey:["FornecedoresEditar",s],exact:!0}),_(B.dashboard.cadastros.fornecedores.listar),null}},enabled:!!s,refetchOnWindowFocus:!1}),de=W.useCallback(async h=>{try{(await L.put("/Fornecedores/v1/Editar",h)).status===200?(g.success("Fornecedores Editado Com Sucesso!"),a.removeQueries({queryKey:["FornecedoresEditar",s],exact:!0}),U(S),_(B.dashboard.cadastros.fornecedores.listar)):g.error("Falha ao Criar Fornecedor")}catch{g.error("Something went wrong!")}},[_]),{refetch:le,isLoading:V}=re({queryKey:["buscaCEP"],queryFn:async()=>{var p;let h=await fe.get(`https://viacep.com.br/ws/${(p=v("cd_CEP"))==null?void 0:p.replace(/\D/g,"")}/json/`);if(h.status===200)return h.data;throw new Error("Cep Inválido")},enabled:!1}),ie=async h=>{var A,J,K,O,Q,H,$,G,Z,X,Y,ee;C(!0);try{var p=v("cd_CEP");if(p=p==null?void 0:p.replace(/\D/g,""),(p==null?void 0:p.length)==8){var E=await le();const xe={cidade:(J=(A=E.data.localidade)==null?void 0:A.toString())==null?void 0:J.toUpperCase(),uf:(O=(K=E.data.uf)==null?void 0:K.toString())==null?void 0:O.toUpperCase()};j("ds_Endereco",(H=(Q=E.data.logradouro)==null?void 0:Q.toString())==null?void 0:H.toUpperCase()),j("nr_Endereco",""),j("ds_Bairro",(G=($=E.data.bairro)==null?void 0:$.toString())==null?void 0:G.toUpperCase()),j("ds_Complemento",(X=(Z=E.data.complemento)==null?void 0:Z.toString())==null?void 0:X.toUpperCase()),j("ds_Cidade",xe),j("cd_UF",(ee=(Y=E.data.uf)==null?void 0:Y.toString())==null?void 0:ee.toUpperCase()),g.success("Endereço capturado com sucesso"),setTimeout(()=>{y("nr_Endereco")},500)}else j("cd_CEP",""),y("cd_CEP"),g.error("CEP Inválido")}finally{C(!1)}},ce=h=>h.replace(/\D/g,"").length>10?["(",/\d/,/\d/,")"," ",/\d/,".",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]:["(",/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/],ue=h=>h.replace(/\D/g,"").length<=11?[/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"-",/\d/,/\d/]:[/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/],me=h=>[/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/];return W.useEffect(()=>{C(V||M||z||w)},[V||M||z||w]),W.useEffect(()=>{I&&(U(I),j("ds_Cidade",{cidade:I.ds_Cidade.toUpperCase(),uf:I.cd_Uf}))},[I]),{Controller:Ce,handleSubmit:D,handleCep:ie,onSubmit:de,setError:d,setFocus:y,setValue:j,clearErrors:R,watch:r,control:T,errors:n,defaultValues:S,isLoadingFull:o,isValidating:x,isSubmitting:w,navigate:_,maskTelefone:ce,maskCpfCnpj:ue,maskCep:me}};function Oe({id_Fornecedor:s}){var{Controller:a,handleSubmit:k,handleCep:C,setValue:_,setFocus:S,onSubmit:T,watch:D,errors:r,control:d,isSubmitting:j,navigate:y,maskTelefone:v,maskCpfCnpj:R,maskCep:U}=Ke(s);return e.jsx("form",{onSubmit:k(T),children:e.jsxs(_e,{children:[e.jsx(ge,{children:e.jsx(b,{divider:e.jsx(ve,{}),spacing:4,children:e.jsxs(b,{spacing:3,children:[e.jsx(oe,{variant:"h6",children:"Informações Basicas"}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{md:2,xs:12,children:e.jsx(a,{control:d,name:"nr_Fornecedor",render:({field:n})=>e.jsxs(l,{error:!!r.nr_Fornecedor,fullWidth:!0,children:[e.jsx(i,{required:!0,children:"N° Fornecedor"}),e.jsx(u,{disabled:!0,readOnly:!0,inputProps:{style:{textAlign:"center"}},...n}),r.nr_Fornecedor?e.jsx(c,{children:r.nr_Fornecedor.message}):null]})})}),e.jsx(t,{md:4,xsOffset:0,xs:12,children:e.jsx(a,{control:d,name:"cd_CpfCnpj",rules:{maxLength:14},render:({field:n})=>e.jsxs(l,{error:!!r.cd_CpfCnpj,fullWidth:!0,children:[e.jsx(i,{required:!0,children:"CPF/CNPJ"}),e.jsx(P,{value:n.value,mask:R,keepCharPositions:!0,guide:!1,render:(o,x)=>e.jsx(u,{inputRef:o,ref:n.ref,...x}),onChange:o=>{n.onChange(o)},onBlur:o=>{n.onBlur()}}),r.cd_CpfCnpj?e.jsx(c,{children:r.cd_CpfCnpj.message}):null]})})}),e.jsx(t,{md:4,xsOffset:0,xs:12,children:e.jsx(a,{control:d,name:"cd_IE",rules:{maxLength:14},render:({field:n})=>e.jsxs(l,{error:!!r.cd_IE,fullWidth:!0,children:[e.jsx(i,{children:"RG/IE"}),e.jsx(u,{...n}),r.cd_IE?e.jsx(c,{children:r.cd_IE.message}):null]})})})]}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{md:6,xs:12,children:e.jsx(a,{control:d,name:"ds_RazaoSocial",render:({field:n})=>e.jsxs(l,{error:!!r.ds_RazaoSocial,fullWidth:!0,children:[e.jsx(i,{required:!0,children:"Razão Social"}),e.jsx(u,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_RazaoSocial?e.jsx(c,{children:r.ds_RazaoSocial.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(a,{control:d,name:"ds_NomeFantasia",render:({field:n})=>e.jsxs(l,{error:!!r.ds_NomeFantasia,fullWidth:!0,children:[e.jsx(i,{children:"Nome Fantasia"}),e.jsx(u,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_NomeFantasia?e.jsx(c,{children:r.ds_NomeFantasia.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(a,{control:d,name:"ds_Email",render:({field:n})=>e.jsxs(l,{error:!!r.ds_Email,fullWidth:!0,children:[e.jsx(i,{children:"E-mail"}),e.jsx(u,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_NomeFantasia?e.jsx(c,{children:r.ds_Email.message}):null]})})}),e.jsx(t,{md:6}),e.jsx(t,{md:3,xs:12,children:e.jsx(a,{control:d,name:"cd_CEP",render:({field:n})=>e.jsxs(l,{error:!!r.cd_CEP,fullWidth:!0,children:[e.jsx(i,{children:"CEP"}),e.jsx(P,{value:n.value,mask:U,keepCharPositions:!0,guide:!1,render:(o,x)=>e.jsx(u,{inputRef:o,ref:n.ref,sx:{paddingRight:0},endAdornment:e.jsx(Ee,{tabIndex:-1,onClick:C,children:e.jsx(qe,{})}),...x}),onChange:o=>{n.onChange(o)},onBlur:o=>{n.onBlur()},onKeyDown:o=>{o.key==="Enter"&&(o.preventDefault(),C(o))}}),r.cd_CEP?e.jsx(c,{children:r.cd_CEP.message}):null]})})}),e.jsx(t,{md:7,xs:12,children:e.jsx(a,{control:d,name:"ds_Endereco",render:({field:n})=>e.jsxs(l,{error:!!r.ds_Endereco,fullWidth:!0,children:[e.jsx(i,{children:"Endereço"}),e.jsx(u,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_Endereco?e.jsx(c,{children:r.ds_Endereco.message}):null]})})}),e.jsx(t,{md:2,xs:12,children:e.jsx(a,{control:d,name:"nr_Endereco",render:({field:n})=>e.jsxs(l,{error:!!r.nr_Endereco,fullWidth:!0,children:[e.jsx(i,{children:"N°"}),e.jsx(u,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.nr_Endereco?e.jsx(c,{children:r.nr_Endereco.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(a,{control:d,name:"ds_Bairro",render:({field:n})=>e.jsxs(l,{error:!!r.ds_Bairro,fullWidth:!0,children:[e.jsx(i,{children:"Bairro"}),e.jsx(u,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_Bairro?e.jsx(c,{children:r.ds_Bairro.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(a,{control:d,name:"ds_Complemento",render:({field:n})=>e.jsxs(l,{error:!!r.ds_Complemento,fullWidth:!0,children:[e.jsx(i,{children:"Complemento"}),e.jsx(u,{inputProps:{style:{textTransform:"uppercase"}},...n}),r.ds_Complemento?e.jsx(c,{children:r.ds_Complemento.message}):null]})})}),e.jsx(t,{md:6,xs:12,children:e.jsx(a,{control:d,name:"ds_Cidade",render:({field:n})=>e.jsxs(l,{error:!!r.ds_Cidade,fullWidth:!0,children:[e.jsx(i,{children:"Cidade"}),e.jsx(Le,{options:[],value:n.value,onChange:(o,x)=>{_("ds_Cidade",x),_("cd_UF",x.uf)}})]})})}),e.jsx(t,{md:2,xs:12,children:e.jsx(a,{control:d,name:"cd_UF",rules:{maxLength:2},render:({field:n})=>e.jsxs(l,{error:!!r.cd_UF,fullWidth:!0,children:[e.jsx(i,{children:"UF"}),e.jsx(u,{inputProps:{maxLength:2,style:{textTransform:"uppercase"}},...n}),r.cd_UF?e.jsx(c,{children:r.cd_UF.message}):null]})})}),e.jsx(t,{md:4,xs:12,children:e.jsx(t,{container:!0,spacing:1,children:e.jsx(t,{xs:!0,children:e.jsx(a,{control:d,name:"nr_Celular",render:({field:n})=>e.jsxs(l,{error:!!r.nr_Celular,fullWidth:!0,children:[e.jsx(i,{children:"Celular"}),e.jsx(P,{value:n.value,mask:v,keepCharPositions:!0,guide:!1,render:(o,x)=>e.jsx(u,{inputRef:o,ref:n.ref,...x}),onChange:o=>{n.onChange(o.target.value)}}),r.nr_Celular?e.jsx(c,{children:r.nr_Celular.message}):null]})})})})}),e.jsx(t,{md:4,xs:12,children:e.jsx(t,{container:!0,spacing:1,children:e.jsx(t,{xs:!0,children:e.jsx(a,{control:d,name:"nr_Telefone",render:({field:n})=>e.jsxs(l,{error:!!r.nr_Telefone,fullWidth:!0,children:[e.jsx(i,{children:"Telefone"}),e.jsx(P,{value:n.value,mask:v,keepCharPositions:!0,guide:!1,render:(o,x)=>e.jsx(u,{inputRef:o,ref:n.ref,...x}),onChange:o=>{n.onChange(o.target.value)}}),r.nr_Telefone?e.jsx(c,{children:r.nr_Telefone.message}):null]})})})})}),e.jsx(t,{md:4,xs:12,children:e.jsx(t,{container:!0,spacing:1,children:e.jsx(t,{xs:!0,children:e.jsx(a,{control:d,name:"nr_Contato",render:({field:n})=>e.jsxs(l,{error:!!r.nr_Contato,fullWidth:!0,children:[e.jsx(i,{children:"Contato"}),e.jsx(P,{value:n.value,mask:v,keepCharPositions:!0,guide:!1,render:(o,x)=>e.jsx(u,{inputRef:o,ref:n.ref,...x}),onChange:o=>{n.onChange(o.target.value)}}),r.nr_Contato?e.jsx(c,{children:r.nr_Contato.message}):null]})})})})}),e.jsx(t,{md:4,xs:12,children:e.jsx(t,{container:!0,spacing:1,children:e.jsx(t,{xs:!0,children:e.jsx(a,{control:d,name:"tp_Status",render:({field:n})=>e.jsxs(l,{error:!!r.tp_Status,fullWidth:!0,children:[e.jsx(i,{children:"Status"}),e.jsxs(De,{...n,fullWidth:!0,children:[e.jsx(N,{value:""}),e.jsx(N,{value:"true",children:"Ativo"}),e.jsx(N,{value:"false",children:"Inativo"})]}),r.nr_Contato?e.jsx(c,{children:r.tp_Status.message}):null]})})})})})]})]})})}),e.jsxs(Fe,{sx:{justifyContent:"flex-end"},children:[e.jsx(ye,{color:"secondary",component:te,onClick:()=>{y(B.dashboard.cadastros.fornecedores.listar)},children:"Cancelar"}),e.jsx(Me,{type:"submit",loadingIndicator:"Salvando...",loading:j,variant:"outlined",children:"Cadastrar Cliente"})]})]})})}const Qe={title:`Details | Products | Dashboard | ${be.site.name}`};function sr(){var{id:s}=Ie();return ae(),e.jsxs(Pe.Fragment,{children:[e.jsx(Be,{children:e.jsx("title",{children:Qe.title})}),e.jsx(Se,{sx:{maxWidth:"var(--Content-maxWidth)",m:"var(--Content-margin)",p:"var(--Content-padding)",width:"var(--Content-width)"},children:e.jsxs(b,{spacing:4,children:[e.jsxs(b,{spacing:3,children:[e.jsx("div",{children:e.jsxs(Ue,{color:"text.primary",component:te,href:B.dashboard.cadastros.fornecedores.listar,sx:{alignItems:"center",display:"inline-flex",gap:1},variant:"subtitle2",children:[e.jsx(ke,{fontSize:"var(--icon-fontSize-md)"}),"Fornecedores"]})}),e.jsx("div",{children:e.jsx(oe,{variant:"h4",children:"Editar Fornecedor"})})]}),e.jsx(Oe,{id_Fornecedor:s})]})})]})}export{sr as Page};
